<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>æ–‡ä»¶ç›¸å…³å‡½æ•°ä¸å·¥å…·å‡½æ•° | ç ´æ™“ï¼šé»‘å¤œä¹‹ä¸­çš„ Electron é£è¡ŒæŒ‡å—</title>
    <meta name="description" content="ğŸ¨ Electron æ²¡é‚£ä¹ˆéš¾">
    
    
    <link rel="preload" href="/electron-flyer/assets/css/0.styles.3d6eb61a.css" as="style"><link rel="preload" href="/electron-flyer/assets/js/app.321478e2.js" as="script"><link rel="preload" href="/electron-flyer/assets/js/22.9864bcb1.js" as="script"><link rel="prefetch" href="/electron-flyer/assets/js/10.d6a7e726.js"><link rel="prefetch" href="/electron-flyer/assets/js/11.887eb323.js"><link rel="prefetch" href="/electron-flyer/assets/js/12.91b28bd0.js"><link rel="prefetch" href="/electron-flyer/assets/js/13.2a080c63.js"><link rel="prefetch" href="/electron-flyer/assets/js/14.e6db4937.js"><link rel="prefetch" href="/electron-flyer/assets/js/15.4888b394.js"><link rel="prefetch" href="/electron-flyer/assets/js/16.6209dfc4.js"><link rel="prefetch" href="/electron-flyer/assets/js/17.4dabdbda.js"><link rel="prefetch" href="/electron-flyer/assets/js/18.d91d10ee.js"><link rel="prefetch" href="/electron-flyer/assets/js/19.2288f168.js"><link rel="prefetch" href="/electron-flyer/assets/js/2.6cf72073.js"><link rel="prefetch" href="/electron-flyer/assets/js/20.1d66ae28.js"><link rel="prefetch" href="/electron-flyer/assets/js/21.1073c24e.js"><link rel="prefetch" href="/electron-flyer/assets/js/23.0099ea93.js"><link rel="prefetch" href="/electron-flyer/assets/js/24.2924e65e.js"><link rel="prefetch" href="/electron-flyer/assets/js/25.9ffdaddc.js"><link rel="prefetch" href="/electron-flyer/assets/js/26.549bcbd0.js"><link rel="prefetch" href="/electron-flyer/assets/js/3.7de79766.js"><link rel="prefetch" href="/electron-flyer/assets/js/4.e4c889ba.js"><link rel="prefetch" href="/electron-flyer/assets/js/5.968ec6b8.js"><link rel="prefetch" href="/electron-flyer/assets/js/6.0f1acbba.js"><link rel="prefetch" href="/electron-flyer/assets/js/7.08f680e1.js"><link rel="prefetch" href="/electron-flyer/assets/js/8.01be9bf3.js"><link rel="prefetch" href="/electron-flyer/assets/js/9.b7ab19cb.js">
    <link rel="stylesheet" href="/electron-flyer/assets/css/0.styles.3d6eb61a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme__container sidebar-open"><div class="row"><div class="col-md-2"><div class="sidebar"><div class="group"><div class="group__title">ç« èŠ‚å†…å®¹</div> <div class="group__body"><!---->  <div name="1.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/1.html">åˆè¯† Electron</a></div> </div><div name="2.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/2.html">äº†è§£ Electron å¼€å‘ç¯å¢ƒ</a></div> </div><div name="3.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/3.html">å°è£…ï¼ˆä¸€ï¼‰</a></div> </div><div name="4.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/4.html">Typescript</a></div> </div><div name="5.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/5.html">è·å–å°è¯´å†…å®¹å‘½ä»¤è¡Œç¨‹åºç‰ˆï¼ˆä¸Šï¼‰</a></div> </div><div name="6.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/6.html" class="router-link-exact-active router-link-active">è·å–å°è¯´å†…å®¹å‘½ä»¤è¡Œç¨‹åºç‰ˆï¼ˆä¸­ï¼‰</a></div> </div><div name="7.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/7.html">è·å–å°è¯´å†…å®¹å‘½ä»¤è¡Œç¨‹åºç‰ˆï¼ˆä¸‹ï¼‰</a></div> </div><div name="8.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/8.html">åµŒå…¥åˆ°åº”ç”¨ä¸­</a></div> </div><div name="9.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/9.html">æ’ä»¶</a></div> </div><div name="10.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/10.html">æ–‡å­—è½¬è¯­éŸ³</a></div> </div><div name="11.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/11.html">è®¾ç½®ä¸ä¿¡å·ä¸­æ–­</a></div> </div><div name="12.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/12.html">æ’ä»¶å•†åº—</a></div> </div><div name="13.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/13.html">ä¸‹è½½ä¸åˆ é™¤ï¼ˆä¸Šï¼‰</a></div> </div><div name="14.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/14.html">ä¸‹è½½ä¸åˆ é™¤ï¼ˆä¸‹ï¼‰</a></div> </div><div name="15.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/15.html">é€šçŸ¥æ ç¨‹åº</a></div> </div><div name="16.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/16.html">æ’­æ”¾åŠŸèƒ½</a></div> </div><div name="17.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/17.html">ç¾åŒ–</a></div> </div><div name="18.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/18.html">æ•°æ®å¯è§†åŒ–ï¼ˆä¸Šï¼‰</a></div> </div><div name="19.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/19.html">æ•°æ®å¯è§†åŒ–ï¼ˆä¸­ï¼‰</a></div> </div><div name="20.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/20.html">æ•°æ®å¯è§†åŒ–ï¼ˆä¸‹ï¼‰</a></div> </div><div name="21.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/21.html">åµŒå…¥åˆ°åº”ç”¨ä¸­</a></div> </div><div name="22.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/22.html">æ‰“åŒ…</a></div> </div></div></div></div></div> <div class="col-md-10"><div class="page__container"><div class="content custom"><h2 id="æ–‡ä»¶ç›¸å…³å‡½æ•°ä¸å·¥å…·å‡½æ•°"><a href="#æ–‡ä»¶ç›¸å…³å‡½æ•°ä¸å·¥å…·å‡½æ•°" aria-hidden="true" class="header-anchor">#</a> æ–‡ä»¶ç›¸å…³å‡½æ•°ä¸å·¥å…·å‡½æ•°</h2> <p>å°†å›è°ƒå¼çš„é£æ ¼å°è£…æˆ <code>Promise</code> é£æ ¼ï¼Œ<code>ensureSavaPath</code> é‡Œé¢å…¶å®æ²¡æœ‰å¿…è¦ç”¨ try/catch ï¼Œç›´æ¥ç”¨ catch å›è°ƒåè€Œæ›´ç®€æ´ï¼Œå½“ç„¶ä¸æƒ³å°è£…è¿™äº›å‡½æ•°ï¼Œä½¿ç”¨ <code>fs-extra</code> é‡Œé¢çš„ API åŒæ ·å¯ä»¥å¿«é€Ÿçš„å®ŒæˆåŒæ ·åŠŸèƒ½ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ä¿å­˜æ–‡ä»¶</span>
<span class="token keyword">const</span> <span class="token function-variable function">saveFile</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">path<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    jsonfile<span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> data<span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      e <span class="token operator">&amp;&amp;</span> <span class="token function">reject</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// ç­‰å¾…</span>
<span class="token keyword">const</span> <span class="token function-variable function">sleep</span> <span class="token operator">=</span> <span class="token parameter">time</span> <span class="token operator">=&gt;</span>
  <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> time<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span>
<span class="token keyword">const</span> <span class="token function-variable function">exits</span> <span class="token operator">=</span> <span class="token parameter">path</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    fs<span class="token punctuation">.</span><span class="token function">stat</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> stats</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      err <span class="token operator">&amp;&amp;</span> <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span>stats<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">ensureSavaPath</span> <span class="token operator">=</span> <span class="token parameter">path</span> <span class="token operator">=&gt;</span> <span class="token function">exits</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">mkdir</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>é‚£ä¹ˆå¯ä¸å¯ä»¥ä¼˜åŒ–ä¸€ä¸‹å‘¢ï¼Ÿå†™æˆä¸€è¡Œè¦æ³¨æ„ï¼Œå› ä¸ºä½¿ç”¨äº†é€—å·ï¼Œé¿å…è¢«è®¤ä¸ºæ˜¯å‡½æ•°çš„å‚æ•°åˆ†å‰²ï¼Œå¯¼è‡´ <code>yes</code> ä¸è¢«è°ƒç”¨ï¼Œå¯ä»¥åŠ ä¸€ä¸ªæ‹¬å·æ‹¬èµ·æ¥ã€‚æœ€å¤–å±‚çš„ä¹Ÿå¯ä»¥å†™æˆä¸€è¡Œï¼Œå¤–å±‚çœŸå†™æˆä¸€è¡Œï¼Œé‚£å°±è¿‡åˆ†äº†ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">ready</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> resolveFN<span class="token punctuation">,</span> rejectFN
  <span class="token keyword">let</span> promise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span>
    <span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">[</span>resolveFN<span class="token punctuation">,</span> rejectFN<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token punctuation">[</span>resolveFN<span class="token punctuation">,</span> rejectFN<span class="token punctuation">,</span> promise<span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token comment">// ä¿å­˜æ–‡ä»¶</span>
<span class="token keyword">const</span> <span class="token function-variable function">saveFile</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">path<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>yes<span class="token punctuation">,</span> no<span class="token punctuation">,</span> wait<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">ready</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  jsonfile<span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> data<span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>e <span class="token operator">&amp;&amp;</span> <span class="token function">no</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">yes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> wait
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">sleep</span> <span class="token operator">=</span> <span class="token parameter">time</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>yes<span class="token punctuation">,</span> no<span class="token punctuation">,</span> wait<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">ready</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span>yes<span class="token punctuation">,</span> time<span class="token punctuation">)</span>
  <span class="token keyword">return</span> wait
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">exits</span> <span class="token operator">=</span> <span class="token parameter">path</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>yes<span class="token punctuation">,</span> no<span class="token punctuation">,</span> wait<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">ready</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  fs<span class="token punctuation">.</span><span class="token function">stat</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e<span class="token punctuation">,</span> stats</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>e <span class="token operator">&amp;&amp;</span> <span class="token function">no</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">yes</span><span class="token punctuation">(</span>stats<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> wait
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">ensureSavaPath</span> <span class="token operator">=</span> <span class="token parameter">path</span> <span class="token operator">=&gt;</span> <span class="token function">exits</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">mkdir</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>å¯¹äº callback çš„å¤„ç†ï¼Œæœ‰ä¸€éƒ¨åˆ†å…±ç”¨äº†ï¼ŒåŒæ ·å¯ä»¥æå–å‡ºæ¥ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">callbackHandler</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">yes<span class="token punctuation">,</span> no</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token parameter">e<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>e <span class="token operator">&amp;&amp;</span> <span class="token function">no</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">yes</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">)</span>
jsonfile<span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> data<span class="token punctuation">,</span> <span class="token function">callbackHandler</span><span class="token punctuation">(</span>yes<span class="token punctuation">,</span> no<span class="token punctuation">)</span><span class="token punctuation">)</span>
fs<span class="token punctuation">.</span><span class="token function">stat</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token function">callbackHandler</span><span class="token punctuation">(</span>yes<span class="token punctuation">,</span> no<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>é‚£ä¹ˆç»§ç»­æŠ½è±¡çš„è¯ï¼Œå…¶å®å¯¹äºè¿™ç§ node ç»Ÿä¸€é£æ ¼çš„éå¸¸å®¹å™¨è½¬æ¢æˆ <code>promise</code>ï¼Œä½¿ç”¨ promisify å³å¯ï¼Œç±»ä¼¼äº <code>Rxjs</code> çš„ <code>bindNodeCallback</code> ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> promisify <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'util'</span><span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">ready</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> resolveFN<span class="token punctuation">,</span> rejectFN
  <span class="token keyword">let</span> promise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span>
    <span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">[</span>resolveFN<span class="token punctuation">,</span> rejectFN<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token punctuation">[</span>resolveFN<span class="token punctuation">,</span> rejectFN<span class="token punctuation">,</span> promise<span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">sleep</span> <span class="token operator">=</span> <span class="token parameter">time</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>yes<span class="token punctuation">,</span> no<span class="token punctuation">,</span> wait<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">ready</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span>yes<span class="token punctuation">,</span> time<span class="token punctuation">)</span>
  <span class="token keyword">return</span> wait
<span class="token punctuation">}</span>

<span class="token comment">// ä¿å­˜æ–‡ä»¶</span>
<span class="token keyword">const</span> saveFile <span class="token operator">=</span> <span class="token function">promisify</span><span class="token punctuation">(</span>jsonfile<span class="token punctuation">.</span>writeFile<span class="token punctuation">)</span>

<span class="token keyword">const</span> exits <span class="token operator">=</span> <span class="token function">promisify</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span>stat<span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token function-variable function">ensureSavaPath</span> <span class="token operator">=</span> <span class="token parameter">path</span> <span class="token operator">=&gt;</span> <span class="token function">exits</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">mkdir</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h1 id="æ ¸å¿ƒé€»è¾‘"><a href="#æ ¸å¿ƒé€»è¾‘" aria-hidden="true" class="header-anchor">#</a> æ ¸å¿ƒé€»è¾‘</h1> <h2 id="ä¸‹è½½ç« èŠ‚"><a href="#ä¸‹è½½ç« èŠ‚" aria-hidden="true" class="header-anchor">#</a> ä¸‹è½½ç« èŠ‚</h2> <p>äº†è§£äº†åŸºç¡€çŸ¥è¯†åï¼Œæˆ‘ä»¬è¿›å…¥æ­£é¢˜ï¼Œ<code>crawl</code> æ˜¯çˆ¬å–è§„åˆ™ï¼Œä¸æŠŠè§„åˆ™å†™åœ¨å†…éƒ¨æ˜¯ä¸ºäº†è§£è€¦ï¼Œæ¯•ç«Ÿä»¥åæ‰©å±•å¯ä¸åªèƒ½å¯¹ä¸€ä¸ªç½‘ç«™æœ‰æ•ˆæœï¼Œè¿™é‡ŒæŠŠ url ä¼ é€’è¿›å»æ˜¯ä¸ºäº†æ–¹ä¾¿æ‹¼æ¥ï¼Œæœ‰çš„ç½‘ç«™ç”¨çš„æ˜¯ç›¸å¯¹ç›®å½•ï¼Œç»Ÿä¸€å¤„ç†æˆç»å¯¹ç›®å½•ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ç½‘å€ - çˆ¬å–è§„åˆ™ - é€‰é¡¹{ç­‰å¾…äº‹ä»¶ï¼Œå¹¶å‘æ•°}</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">downloadChapter</span><span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> crawl<span class="token punctuation">,</span> opts</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> path<span class="token punctuation">,</span> charset <span class="token punctuation">}</span> <span class="token operator">=</span> opts
  <span class="token keyword">const</span> selector <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">buildSelector</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> charset<span class="token punctuation">)</span>
  <span class="token keyword">const</span> datas <span class="token operator">=</span> crawl<span class="token punctuation">.</span><span class="token function">chapter</span><span class="token punctuation">(</span>selector<span class="token punctuation">,</span> url<span class="token punctuation">)</span>
  <span class="token keyword">await</span> <span class="token function">saveFile</span><span class="token punctuation">(</span><span class="token function">resolve</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token string">'chapters.json'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> datas<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="ä¸‹è½½å†…å®¹"><a href="#ä¸‹è½½å†…å®¹" aria-hidden="true" class="header-anchor">#</a> ä¸‹è½½å†…å®¹</h2> <p>å½“ä¸‹è½½å†…å®¹æ—¶å€™ï¼ŒåŒæ ·é€‚ç”¨ <code>craw</code> æä¾›çš„çˆ¬å–å†…å®¹çš„è§„åˆ™ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">downloadText</span><span class="token punctuation">(</span><span class="token parameter">chapter<span class="token punctuation">,</span> crawl<span class="token punctuation">,</span> index<span class="token punctuation">,</span> opts</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> path<span class="token punctuation">,</span> charset <span class="token punctuation">}</span> <span class="token operator">=</span> opts
  <span class="token keyword">const</span> selector <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">buildSelector</span><span class="token punctuation">(</span>chapter<span class="token punctuation">.</span>url<span class="token punctuation">,</span> charset<span class="token punctuation">)</span>
  <span class="token keyword">const</span> text <span class="token operator">=</span> crawl<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span>
  <span class="token keyword">await</span> <span class="token function">saveFile</span><span class="token punctuation">(</span><span class="token function">resolve</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token template-string"><span class="token string">`text/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>index<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>chapter<span class="token punctuation">.</span>title<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.json`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span> text<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <div class="content__footer-container"><div class="content__footer"><!----> <!----></div></div></div></div></div></div></div>
    <script src="/electron-flyer/assets/js/app.321478e2.js" defer></script><script src="/electron-flyer/assets/js/22.9864bcb1.js" defer></script>
  </body>
</html>
