<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>方块版本 | 破晓：黑夜之中的 Electron 飞行指南</title>
    <meta name="description" content="🎨 Electron 没那么难">
    
    
    <link rel="preload" href="/electron-flyer/assets/css/0.styles.3d6eb61a.css" as="style"><link rel="preload" href="/electron-flyer/assets/js/app.321478e2.js" as="script"><link rel="preload" href="/electron-flyer/assets/js/3.7de79766.js" as="script"><link rel="prefetch" href="/electron-flyer/assets/js/10.d6a7e726.js"><link rel="prefetch" href="/electron-flyer/assets/js/11.887eb323.js"><link rel="prefetch" href="/electron-flyer/assets/js/12.91b28bd0.js"><link rel="prefetch" href="/electron-flyer/assets/js/13.2a080c63.js"><link rel="prefetch" href="/electron-flyer/assets/js/14.e6db4937.js"><link rel="prefetch" href="/electron-flyer/assets/js/15.4888b394.js"><link rel="prefetch" href="/electron-flyer/assets/js/16.6209dfc4.js"><link rel="prefetch" href="/electron-flyer/assets/js/17.4dabdbda.js"><link rel="prefetch" href="/electron-flyer/assets/js/18.d91d10ee.js"><link rel="prefetch" href="/electron-flyer/assets/js/19.2288f168.js"><link rel="prefetch" href="/electron-flyer/assets/js/2.6cf72073.js"><link rel="prefetch" href="/electron-flyer/assets/js/20.1d66ae28.js"><link rel="prefetch" href="/electron-flyer/assets/js/21.1073c24e.js"><link rel="prefetch" href="/electron-flyer/assets/js/22.9864bcb1.js"><link rel="prefetch" href="/electron-flyer/assets/js/23.0099ea93.js"><link rel="prefetch" href="/electron-flyer/assets/js/24.2924e65e.js"><link rel="prefetch" href="/electron-flyer/assets/js/25.9ffdaddc.js"><link rel="prefetch" href="/electron-flyer/assets/js/26.549bcbd0.js"><link rel="prefetch" href="/electron-flyer/assets/js/4.e4c889ba.js"><link rel="prefetch" href="/electron-flyer/assets/js/5.968ec6b8.js"><link rel="prefetch" href="/electron-flyer/assets/js/6.0f1acbba.js"><link rel="prefetch" href="/electron-flyer/assets/js/7.08f680e1.js"><link rel="prefetch" href="/electron-flyer/assets/js/8.01be9bf3.js"><link rel="prefetch" href="/electron-flyer/assets/js/9.b7ab19cb.js">
    <link rel="stylesheet" href="/electron-flyer/assets/css/0.styles.3d6eb61a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme__container sidebar-open"><div class="row"><div class="col-md-2"><div class="sidebar"><div class="group"><div class="group__title">章节内容</div> <div class="group__body"><!---->  <div name="1.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/1.html">初识 Electron</a></div> </div><div name="2.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/2.html">了解 Electron 开发环境</a></div> </div><div name="3.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/3.html">封装（一）</a></div> </div><div name="4.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/4.html">Typescript</a></div> </div><div name="5.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/5.html">获取小说内容命令行程序版（上）</a></div> </div><div name="6.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/6.html">获取小说内容命令行程序版（中）</a></div> </div><div name="7.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/7.html">获取小说内容命令行程序版（下）</a></div> </div><div name="8.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/8.html">嵌入到应用中</a></div> </div><div name="9.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/9.html">插件</a></div> </div><div name="10.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/10.html">文字转语音</a></div> </div><div name="11.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/11.html">设置与信号中断</a></div> </div><div name="12.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/12.html">插件商店</a></div> </div><div name="13.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/13.html">下载与删除（上）</a></div> </div><div name="14.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/14.html">下载与删除（下）</a></div> </div><div name="15.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/15.html">通知栏程序</a></div> </div><div name="16.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/16.html">播放功能</a></div> </div><div name="17.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/17.html">美化</a></div> </div><div name="18.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/18.html">数据可视化（上）</a></div> </div><div name="19.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/19.html" class="router-link-exact-active router-link-active">数据可视化（中）</a></div> </div><div name="20.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/20.html">数据可视化（下）</a></div> </div><div name="21.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/21.html">嵌入到应用中</a></div> </div><div name="22.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/22.html">打包</a></div> </div></div></div></div></div> <div class="col-md-10"><div class="page__container"><div class="content custom"><h2 id="方块版本"><a href="#方块版本" aria-hidden="true" class="header-anchor">#</a> 方块版本</h2> <p>添加绿色的至高点，使用 setTimeout 放慢速度便于观察。</p> <p><img src="data:image/gif;base64,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" alt></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> GreenHight <span class="token operator">=</span> <span class="token number">0</span>

<span class="token keyword">function</span> <span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> ramdom <span class="token operator">=</span> <span class="token number">255</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">let</span> maxSize <span class="token operator">=</span> <span class="token number">20</span> <span class="token comment">// -&gt; 255</span>
  currentSize <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ramdom <span class="token operator">/</span> <span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">*</span> maxSize<span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">clearRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">)</span>

  ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">'red'</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> currentSize<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> height <span class="token operator">-</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> h <span class="token operator">-</span> margin <span class="token operator">*</span> i<span class="token punctuation">,</span> w<span class="token punctuation">,</span> h<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">'green'</span>

  currentGreenHight <span class="token operator">=</span> height <span class="token operator">-</span> <span class="token punctuation">(</span>currentSize <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> h <span class="token operator">-</span> margin <span class="token operator">*</span> currentSize <span class="token comment">// 至高点</span>

  ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> currentGreenHight<span class="token punctuation">,</span> w<span class="token punctuation">,</span> h<span class="token punctuation">)</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span>Run<span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>我们希望绿色的砖块可以被顶上去，下来的时候做自由落体。让绿色的下降速度为，每帧下降一个小块的高度，当下降超过之高点就停在制高点的位置。</p> <p>这里要特别注意 y 轴的坐标，0 是左上角，最大是左下角。绿色球越往下落，y 越大，当与至高点的碰撞的时候，让他就等于至高点的位置，测试的时候发现会跌过头了，所以加了个 <code>2 * v</code> 或者 <code>v</code> 都行。</p> <p><img src="data:image/gif;base64,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" alt></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> GreenHight <span class="token operator">=</span> height

<span class="token keyword">let</span> v <span class="token operator">=</span> h <span class="token operator">+</span> margin <span class="token comment">// 下降速度</span>

<span class="token keyword">function</span> <span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> ramdom <span class="token operator">=</span> <span class="token number">255</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">let</span> maxSize <span class="token operator">=</span> <span class="token number">20</span> <span class="token comment">// -&gt; 255</span>
  currentSize <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ramdom <span class="token operator">/</span> <span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">*</span> maxSize<span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">clearRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">)</span>

  ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">'red'</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> currentSize<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> height <span class="token operator">-</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> h <span class="token operator">-</span> margin <span class="token operator">*</span> i<span class="token punctuation">,</span> w<span class="token punctuation">,</span> h<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">'green'</span>

  currentGreenHight <span class="token operator">=</span> height <span class="token operator">-</span> <span class="token punctuation">(</span>currentSize <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> h <span class="token operator">-</span> margin <span class="token operator">*</span> currentSize <span class="token comment">// 制高点  y 坐标。</span>

  <span class="token comment">// 大 下面</span>
  <span class="token comment">// 小 上面</span>

  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>GreenHight<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>currentGreenHight<span class="token punctuation">)</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>GreenHight <span class="token operator">+</span> v <span class="token operator">&gt;</span> currentGreenHight<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 比最高点还大，跌过头了</span>
    <span class="token comment">// 保证等会的 + v 也不过头</span>
    GreenHight <span class="token operator">=</span> currentGreenHight
    ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> GreenHight<span class="token punctuation">,</span> w<span class="token punctuation">,</span> h<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    GreenHight <span class="token operator">+=</span> v
    ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> GreenHight<span class="token punctuation">,</span> w<span class="token punctuation">,</span> h<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">setTimeout</span><span class="token punctuation">(</span>Run<span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>想让下落幅度大一点？</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token punctuation">(</span>h <span class="token operator">+</span> margin<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">3</span> <span class="token comment">// 下降速度</span>
</code></pre></div><p>接下来实现纵向的逻辑</p> <p><img src="/electron-flyer/assets/img/cvs6.526bd145.gif" alt></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  ctx<span class="token punctuation">.</span><span class="token function">clearRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">'red'</span>
  <span class="token keyword">let</span> widthSize <span class="token operator">=</span> <span class="token number">20</span> <span class="token comment">// 横向列数</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> widthSize<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> ramdom <span class="token operator">=</span> <span class="token number">255</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> maxSize <span class="token operator">=</span> <span class="token number">20</span>
    currentSize <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ramdom <span class="token operator">/</span> <span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">*</span> maxSize<span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> currentSize<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span>j <span class="token operator">*</span> w <span class="token operator">+</span> margin <span class="token operator">*</span> j<span class="token punctuation">,</span> height <span class="token operator">-</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> h <span class="token operator">-</span> margin <span class="token operator">*</span> i<span class="token punctuation">,</span> w<span class="token punctuation">,</span> h<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span>Run<span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>添加绿色方块，oh~ 诶瑞巴蒂，跟我一起 high。把之前的绿块高度用数组保存。因为里面的循环是 &lt;= 所以，应该  <code>new Array</code> 还要加一个。</p> <p><img src="/electron-flyer/assets/img/cvs7.e6fc1537.gif" alt></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> widthSize <span class="token operator">=</span> <span class="token number">20</span>
<span class="token keyword">let</span> GreenHightArray <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span>widthSize <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span>height<span class="token punctuation">)</span>
<span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token punctuation">(</span>h <span class="token operator">+</span> margin<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">3</span> <span class="token comment">// 下降速度</span>
<span class="token keyword">function</span> <span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  ctx<span class="token punctuation">.</span><span class="token function">clearRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">)</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> widthSize<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> ramdom <span class="token operator">=</span> <span class="token number">255</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> maxSize <span class="token operator">=</span> <span class="token number">20</span> <span class="token comment">// -&gt; 255</span>
    currentSize <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ramdom <span class="token operator">/</span> <span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">*</span> maxSize<span class="token punctuation">)</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> currentSize<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">'red'</span>

      ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span>j <span class="token operator">*</span> w <span class="token operator">+</span> margin <span class="token operator">*</span> j<span class="token punctuation">,</span> height <span class="token operator">-</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> h <span class="token operator">-</span> margin <span class="token operator">*</span> i<span class="token punctuation">,</span> w<span class="token punctuation">,</span> h<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 绿块逻辑</span>
    ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">'green'</span>

    currentGreenHight <span class="token operator">=</span> height <span class="token operator">-</span> <span class="token punctuation">(</span>currentSize <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> h <span class="token operator">-</span> margin <span class="token operator">*</span> currentSize <span class="token comment">// 制高点  y 坐标。</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>GreenHightArray<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> v <span class="token operator">&gt;</span> currentGreenHight<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      GreenHightArray<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> currentGreenHight
      ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span>j <span class="token operator">*</span> w <span class="token operator">+</span> margin <span class="token operator">*</span> j<span class="token punctuation">,</span> GreenHightArray<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> w<span class="token punctuation">,</span> h<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      GreenHightArray<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+=</span> v
      ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span>j <span class="token operator">*</span> w <span class="token operator">+</span> margin <span class="token operator">*</span> j<span class="token punctuation">,</span> GreenHightArray<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> w<span class="token punctuation">,</span> h<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span>Run<span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div></div> <div class="content__footer-container"><div class="content__footer"><!----> <!----></div></div></div></div></div></div></div>
    <script src="/electron-flyer/assets/js/app.321478e2.js" defer></script><script src="/electron-flyer/assets/js/3.7de79766.js" defer></script>
  </body>
</html>
