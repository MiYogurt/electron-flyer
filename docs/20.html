<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>渐变版本 | 破晓：黑夜之中的 Electron 飞行指南</title>
    <meta name="description" content="🎨 Electron 没那么难">
    
    
    <link rel="preload" href="/electron-flyer/assets/css/0.styles.3d6eb61a.css" as="style"><link rel="preload" href="/electron-flyer/assets/js/app.22e63a91.js" as="script"><link rel="preload" href="/electron-flyer/assets/js/5.968ec6b8.js" as="script"><link rel="prefetch" href="/electron-flyer/assets/js/10.d6a7e726.js"><link rel="prefetch" href="/electron-flyer/assets/js/11.887eb323.js"><link rel="prefetch" href="/electron-flyer/assets/js/12.91b28bd0.js"><link rel="prefetch" href="/electron-flyer/assets/js/13.2a080c63.js"><link rel="prefetch" href="/electron-flyer/assets/js/14.e6db4937.js"><link rel="prefetch" href="/electron-flyer/assets/js/15.4888b394.js"><link rel="prefetch" href="/electron-flyer/assets/js/16.6209dfc4.js"><link rel="prefetch" href="/electron-flyer/assets/js/17.4dabdbda.js"><link rel="prefetch" href="/electron-flyer/assets/js/18.d91d10ee.js"><link rel="prefetch" href="/electron-flyer/assets/js/19.2288f168.js"><link rel="prefetch" href="/electron-flyer/assets/js/2.182ecb78.js"><link rel="prefetch" href="/electron-flyer/assets/js/20.1d66ae28.js"><link rel="prefetch" href="/electron-flyer/assets/js/21.1073c24e.js"><link rel="prefetch" href="/electron-flyer/assets/js/22.9864bcb1.js"><link rel="prefetch" href="/electron-flyer/assets/js/23.0099ea93.js"><link rel="prefetch" href="/electron-flyer/assets/js/24.2924e65e.js"><link rel="prefetch" href="/electron-flyer/assets/js/25.9ffdaddc.js"><link rel="prefetch" href="/electron-flyer/assets/js/26.549bcbd0.js"><link rel="prefetch" href="/electron-flyer/assets/js/3.7de79766.js"><link rel="prefetch" href="/electron-flyer/assets/js/4.fa89f104.js"><link rel="prefetch" href="/electron-flyer/assets/js/6.0f1acbba.js"><link rel="prefetch" href="/electron-flyer/assets/js/7.08f680e1.js"><link rel="prefetch" href="/electron-flyer/assets/js/8.01be9bf3.js"><link rel="prefetch" href="/electron-flyer/assets/js/9.b7ab19cb.js">
    <link rel="stylesheet" href="/electron-flyer/assets/css/0.styles.3d6eb61a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme__container sidebar-open"><div class="row"><div class="col-md-2"><div class="sidebar"><div class="group"><div class="group__title">章节内容</div> <div class="group__body"><!---->  <div name="1.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/1.html">历史介绍</a></div> </div><div name="2.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/2.html">开发环境</a></div> </div><div name="3.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/3.html">代码封装</a></div> </div><div name="4.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/4.html">函数式</a></div> </div><div name="5.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/5.html">获取小说命令行版（上）</a></div> </div><div name="6.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/6.html">获取小说命令行版（中）</a></div> </div><div name="7.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/7.html">获取小说命令行版（下）</a></div> </div><div name="8.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/8.html">嵌入到应用中</a></div> </div><div name="9.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/9.html">插件机制</a></div> </div><div name="10.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/10.html">文字转语音</a></div> </div><div name="11.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/11.html">设置与信号中断</a></div> </div><div name="12.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/12.html">插件商店</a></div> </div><div name="13.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/13.html">下载与删除（上）</a></div> </div><div name="14.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/14.html">下载与删除（下）</a></div> </div><div name="15.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/15.html">通知栏程序</a></div> </div><div name="16.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/16.html">播放功能</a></div> </div><div name="17.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/17.html">美化界面</a></div> </div><div name="18.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/18.html">数据可视化（上）</a></div> </div><div name="19.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/19.html">数据可视化（中）</a></div> </div><div name="20.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/20.html" class="router-link-exact-active router-link-active">数据可视化（下）</a></div> </div><div name="21.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/21.html">嵌入到应用中</a></div> </div><div name="22.html" class="group__category category"><div class="category__label"><a href="/electron-flyer/22.html">打包应用</a></div> </div></div></div></div></div> <div class="col-md-10"><div class="page__container"><div class="content custom"><h2 id="渐变版本"><a href="#渐变版本" aria-hidden="true" class="header-anchor">#</a> 渐变版本</h2> <p>没有渐变，似乎总少点什么，可不可以来点渐变。假如上渐变的话，需要改变一下思路，这个思路更加优秀，绘制的数量更少。对于这种间隔，我们通过 clearRect 清楚即可。</p> <p>现在都是确定高度，然后以全局高度减去矩形高度为坐标 y，画完的小方块刚好以底部对齐。</p> <p><code>show me code</code></p> <p><img src="/electron-flyer/assets/img/cvs8.6f4a450b.gif" alt></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> widthSize <span class="token operator">=</span> <span class="token number">20</span>
<span class="token keyword">let</span> GreenHightArray <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span>widthSize <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span>height<span class="token punctuation">)</span>
<span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token punctuation">(</span>h <span class="token operator">+</span> margin<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">3</span>
<span class="token keyword">let</span> maxSize <span class="token operator">=</span> <span class="token number">20</span>
<span class="token keyword">function</span> <span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  ctx<span class="token punctuation">.</span><span class="token function">clearRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">)</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> widthSize<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> ramdom <span class="token operator">=</span> <span class="token number">255</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    currentSize <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ramdom <span class="token operator">/</span> <span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">*</span> maxSize<span class="token punctuation">)</span>

    ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">'red'</span>

    ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span>
      j <span class="token operator">*</span> w <span class="token operator">+</span> margin <span class="token operator">*</span> j<span class="token punctuation">,</span>
      height <span class="token operator">-</span> h <span class="token operator">*</span> currentSize<span class="token punctuation">,</span>
      w<span class="token punctuation">,</span>
      h <span class="token operator">*</span> currentSize
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span>Run<span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>添加渐变样式</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> g <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">createLinearGradient</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> height<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
g<span class="token punctuation">.</span><span class="token function">addColorStop</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'#283149'</span><span class="token punctuation">)</span>
g<span class="token punctuation">.</span><span class="token function">addColorStop</span><span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token string">'#ff7a5c'</span><span class="token punctuation">)</span>
g<span class="token punctuation">.</span><span class="token function">addColorStop</span><span class="token punctuation">(</span><span class="token number">0.6</span><span class="token punctuation">,</span> <span class="token string">'#c93d1b'</span><span class="token punctuation">)</span>
ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> g
</code></pre></div><p>添加小绿块</p> <p><img src="/electron-flyer/assets/img/cvs9.a3bd7b9f.gif" alt></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  ctx<span class="token punctuation">.</span><span class="token function">clearRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">)</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> widthSize<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> ramdom <span class="token operator">=</span> <span class="token number">255</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    currentSize <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ramdom <span class="token operator">/</span> <span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">*</span> maxSize<span class="token punctuation">)</span>

    <span class="token keyword">let</span> g <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">createLinearGradient</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> height<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    g<span class="token punctuation">.</span><span class="token function">addColorStop</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'#283149'</span><span class="token punctuation">)</span>
    g<span class="token punctuation">.</span><span class="token function">addColorStop</span><span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token string">'#ff7a5c'</span><span class="token punctuation">)</span>
    g<span class="token punctuation">.</span><span class="token function">addColorStop</span><span class="token punctuation">(</span><span class="token number">0.6</span><span class="token punctuation">,</span> <span class="token string">'#c93d1b'</span><span class="token punctuation">)</span>
    ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> g

    ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span>
      j <span class="token operator">*</span> w <span class="token operator">+</span> margin <span class="token operator">*</span> j<span class="token punctuation">,</span>
      height <span class="token operator">-</span> h <span class="token operator">*</span> currentSize<span class="token punctuation">,</span>
      w<span class="token punctuation">,</span>
      h <span class="token operator">*</span> currentSize
    <span class="token punctuation">)</span>

    <span class="token comment">// 绿块逻辑</span>
    ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">'green'</span>

    currentGreenHight <span class="token operator">=</span> height <span class="token operator">-</span> currentSize <span class="token operator">*</span> h <span class="token comment">// 制高点 y 坐标。</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>GreenHightArray<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+</span> v <span class="token operator">&gt;</span> currentGreenHight<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      GreenHightArray<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> currentGreenHight
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>
      ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span>j <span class="token operator">*</span> w <span class="token operator">+</span> margin <span class="token operator">*</span> j<span class="token punctuation">,</span> GreenHightArray<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> w<span class="token punctuation">,</span> h<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      GreenHightArray<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+=</span> v
      ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span>j <span class="token operator">*</span> w <span class="token operator">+</span> margin <span class="token operator">*</span> j<span class="token punctuation">,</span> GreenHightArray<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> w<span class="token punctuation">,</span> h<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span>Run<span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>分割网格</p> <p><img src="/electron-flyer/assets/img/cvs10.be920fc7.gif" alt></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> widthSize <span class="token operator">=</span> <span class="token number">20</span>
<span class="token keyword">let</span> GreenHightArray <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span>widthSize <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span>height<span class="token punctuation">)</span>
<span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token punctuation">(</span>h <span class="token operator">+</span> margin<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token comment">// 下降速度</span>

<span class="token keyword">let</span> maxSize <span class="token operator">=</span> <span class="token number">30</span> <span class="token comment">// -&gt; 255</span>
<span class="token keyword">let</span> lines <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>height <span class="token operator">/</span> <span class="token punctuation">(</span>h <span class="token operator">+</span> margin<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 计算行数</span>
<span class="token keyword">function</span> <span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  ctx<span class="token punctuation">.</span><span class="token function">clearRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">)</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> widthSize<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> ramdom <span class="token operator">=</span> <span class="token number">255</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    currentSize <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ramdom <span class="token operator">/</span> <span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">*</span> maxSize<span class="token punctuation">)</span>

    <span class="token keyword">let</span> g <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">createLinearGradient</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> height<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    g<span class="token punctuation">.</span><span class="token function">addColorStop</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'#283149'</span><span class="token punctuation">)</span>
    g<span class="token punctuation">.</span><span class="token function">addColorStop</span><span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token string">'#ff7a5c'</span><span class="token punctuation">)</span>
    g<span class="token punctuation">.</span><span class="token function">addColorStop</span><span class="token punctuation">(</span><span class="token number">0.6</span><span class="token punctuation">,</span> <span class="token string">'#c93d1b'</span><span class="token punctuation">)</span>
    ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> g

    ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span>
      j <span class="token operator">*</span> w <span class="token operator">+</span> margin <span class="token operator">*</span> j<span class="token punctuation">,</span>
      height <span class="token operator">-</span> h <span class="token operator">*</span> currentSize<span class="token punctuation">,</span>
      w<span class="token punctuation">,</span>
      h <span class="token operator">*</span> currentSize
    <span class="token punctuation">)</span>

    <span class="token comment">// 绿块逻辑</span>
    ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">'green'</span>
    currentGreenHight <span class="token operator">=</span> height <span class="token operator">-</span> currentSize <span class="token operator">*</span> h <span class="token comment">// 制高点 y 坐标。</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>GreenHightArray<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&gt;</span> currentGreenHight<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      GreenHightArray<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> currentGreenHight
      ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span>j <span class="token operator">*</span> w <span class="token operator">+</span> margin <span class="token operator">*</span> j<span class="token punctuation">,</span> GreenHightArray<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> w<span class="token punctuation">,</span> h<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      GreenHightArray<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+=</span> v
      ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span>j <span class="token operator">*</span> w <span class="token operator">+</span> margin <span class="token operator">*</span> j<span class="token punctuation">,</span> GreenHightArray<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> w<span class="token punctuation">,</span> h<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> lines<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span><span class="token function">clearRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> height <span class="token operator">-</span> i <span class="token operator">*</span> h<span class="token punctuation">,</span> width<span class="token punctuation">,</span> margin<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span>Run<span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>上面切割的不准确，说明某处的 <code>margin</code> 没加上。仔细检查，现在所有的块绘制的高度都是 <code>h + margin</code>，然后用 clearRect 进行切割。</p> <p><img src="/electron-flyer/assets/img/cvs11.d9ea425e.gif" alt></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> w <span class="token operator">=</span> <span class="token number">20</span>
<span class="token keyword">let</span> h <span class="token operator">=</span> <span class="token number">10</span>

<span class="token keyword">let</span> margin <span class="token operator">=</span> <span class="token number">2</span> <span class="token comment">// 间隔</span>

<span class="token comment">// let GreenHight = height</span>
<span class="token keyword">let</span> widthSize <span class="token operator">=</span> <span class="token number">20</span>
<span class="token keyword">let</span> GreenHightArray <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span>widthSize <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span>height<span class="token punctuation">)</span>
<span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token punctuation">(</span>h <span class="token operator">+</span> margin<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">3</span> <span class="token comment">// 下降速度</span>

<span class="token keyword">let</span> maxSize <span class="token operator">=</span> <span class="token number">24</span> <span class="token comment">// -&gt; 255</span>
<span class="token keyword">let</span> lines <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>height <span class="token operator">/</span> <span class="token punctuation">(</span>h <span class="token operator">+</span> margin<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 计算行数</span>

<span class="token keyword">function</span> <span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  ctx<span class="token punctuation">.</span><span class="token function">clearRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">)</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> widthSize<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> ramdom <span class="token operator">=</span> <span class="token number">255</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    currentSize <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ramdom <span class="token operator">/</span> <span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">*</span> maxSize<span class="token punctuation">)</span>

    <span class="token keyword">let</span> g <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">createLinearGradient</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> height<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    g<span class="token punctuation">.</span><span class="token function">addColorStop</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'#233142'</span><span class="token punctuation">)</span>
    g<span class="token punctuation">.</span><span class="token function">addColorStop</span><span class="token punctuation">(</span><span class="token number">0.6</span><span class="token punctuation">,</span> <span class="token string">'#455d7a'</span><span class="token punctuation">)</span>
    g<span class="token punctuation">.</span><span class="token function">addColorStop</span><span class="token punctuation">(</span><span class="token number">0.8</span><span class="token punctuation">,</span> <span class="token string">'#f95959'</span><span class="token punctuation">)</span>
    ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> g

    ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span>
      j <span class="token operator">*</span> w <span class="token operator">+</span> margin <span class="token operator">*</span> j<span class="token punctuation">,</span>
      height <span class="token operator">-</span> <span class="token punctuation">(</span>h <span class="token operator">+</span> margin<span class="token punctuation">)</span> <span class="token operator">*</span> currentSize<span class="token punctuation">,</span>
      w<span class="token punctuation">,</span>
      <span class="token punctuation">(</span>h <span class="token operator">+</span> margin<span class="token punctuation">)</span> <span class="token operator">*</span> currentSize
    <span class="token punctuation">)</span>

    <span class="token comment">// 绿块逻辑</span>
    ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">'green'</span>

    currentGreenHight <span class="token operator">=</span> height <span class="token operator">-</span> currentSize <span class="token operator">*</span> <span class="token punctuation">(</span>h <span class="token operator">+</span> margin<span class="token punctuation">)</span> <span class="token comment">// 制高点 y 坐标。</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>GreenHightArray<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+</span> v <span class="token operator">&gt;</span> currentGreenHight<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      GreenHightArray<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> currentGreenHight
      ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span>j <span class="token operator">*</span> w <span class="token operator">+</span> margin <span class="token operator">*</span> j<span class="token punctuation">,</span> GreenHightArray<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> w<span class="token punctuation">,</span> h <span class="token operator">+</span> margin<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      GreenHightArray<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+=</span> v
      ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span>j <span class="token operator">*</span> w <span class="token operator">+</span> margin <span class="token operator">*</span> j<span class="token punctuation">,</span> GreenHightArray<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> w<span class="token punctuation">,</span> h <span class="token operator">+</span> margin<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> lines<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span><span class="token function">clearRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> height <span class="token operator">-</span> i <span class="token operator">*</span> <span class="token punctuation">(</span>h <span class="token operator">+</span> margin<span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token punctuation">,</span> margin<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span>Run<span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div></div> <div class="content__footer-container"><div class="content__footer"><!----> <!----></div></div></div></div></div></div></div>
    <script src="/electron-flyer/assets/js/app.22e63a91.js" defer></script><script src="/electron-flyer/assets/js/5.968ec6b8.js" defer></script>
  </body>
</html>
